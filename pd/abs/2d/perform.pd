#N canvas 740 100 729 548 10;
#X obj 11 339 list;
#X obj 77 229 t l l, f 6;
#X obj 32 315 spigot, f 8;
#X obj 50 108 t f f;
#X obj 96 318 spigot;
#X obj 75 339 f, f 4;
#N canvas 0 22 244 195 mat.vec.mul 0;
#X obj 111 12 inlet;
#X obj 20 12 inlet;
#X obj 20 98 *;
#X obj 47 98 *;
#X obj 20 120 +, f 5;
#X obj 74 98 *;
#X obj 101 98 *;
#X obj 74 120 +, f 5;
#X obj 20 34 unpack f f f f;
#X obj 20 142 pack f f;
#X obj 20 164 outlet;
#X obj 151 12 inlet;
#X connect 0 0 2 1;
#X connect 0 0 5 1;
#X connect 1 0 8 0;
#X connect 2 0 4 0;
#X connect 3 0 4 1;
#X connect 4 0 9 0;
#X connect 5 0 7 0;
#X connect 6 0 7 1;
#X connect 7 0 9 1;
#X connect 8 0 2 0;
#X connect 8 1 3 0;
#X connect 8 2 5 0;
#X connect 8 3 6 0;
#X connect 9 0 10 0;
#X connect 11 0 6 1;
#X connect 11 0 3 1;
#X restore 77 207 pd mat.vec.mul;
#X obj 132 116 loadbang;
#X obj 132 138 f 4;
#N canvas 0 22 193 267 loop 0;
#X obj 8 60 until;
#X obj 8 82 f, f 7;
#X obj 47 60 f 0;
#X obj 59 82 + 1;
#X obj 8 32 t b b, f 7;
#X obj 8 8 inlet;
#X obj 47 158 outlet;
#X obj 8 181 outlet;
#X obj 47 111 r \$0-nmatrices;
#X obj 8 134 sel 256;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 1 0 9 0;
#X connect 2 0 1 1;
#X connect 3 0 1 1;
#X connect 4 0 0 0;
#X connect 4 1 2 0;
#X connect 5 0 4 0;
#X connect 8 0 9 1;
#X connect 9 0 7 0;
#X connect 9 0 0 1;
#X connect 9 1 6 0;
#X restore 11 84 pd loop;
#N canvas 0 22 508 262 to.p 1;
#X obj 21 114 t f f, f 8;
#X obj 21 178 outlet;
#X obj 21 46 inlet;
#X text 18 13 The unit-length vector PT = [p1 \, p2]T \, which points
toward the virtual source. T denotes the matrix transposition.;
#X obj 66 178 outlet;
#X obj 21 68 * 3.14159;
#X obj 21 90 / 180;
#X obj 21 136 sin;
#X obj 21 158 * -1;
#X obj 66 136 cos;
#X connect 0 0 7 0;
#X connect 0 1 9 0;
#X connect 2 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 0 0;
#X connect 7 0 8 0;
#X connect 8 0 1 0;
#X connect 9 0 4 0;
#X restore 117 184 pd to.p;
#X obj 11 500 outlet;
#N canvas 0 22 450 336 pass 0;
#X obj 52 58 unpack f f;
#X obj 52 237 >;
#X obj 19 260 spigot;
#X obj 19 215 t f f, f 6;
#X obj 19 14 inlet;
#X obj 52 292 outlet;
#X obj 19 36 t l l, f 6;
#X obj 19 143 spigot;
#N canvas 0 22 450 300 g.factor 0;
#X obj 9 28 unpack f f;
#X obj 66 73 *, f 5;
#X obj 9 73 *, f 5;
#X obj 9 95 +, f 10;
#X obj 9 117 sqrt;
#X obj 9 7 inlet;
#X obj 66 51 t f f;
#X obj 9 51 t f f;
#X obj 9 139 outlet;
#X connect 0 0 7 0;
#X connect 0 1 6 0;
#X connect 1 0 3 1;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 8 0;
#X connect 5 0 0 0;
#X connect 6 0 1 0;
#X connect 6 1 1 1;
#X connect 7 0 2 0;
#X connect 7 1 2 1;
#X restore 19 164 pd g.factor;
#X obj 102 134 sel 0;
#X obj 102 156 f 0;
#X obj 52 102 *, f 10;
#X obj 67 213 f 0;
#X obj 67 188 r \$0-clear;
#X obj 52 80 >= 0;
#X obj 109 80 >= 0;
#X connect 0 0 14 0;
#X connect 0 1 15 0;
#X connect 1 0 2 1;
#X connect 1 0 5 0;
#X connect 2 0 1 1;
#X connect 3 0 2 0;
#X connect 3 1 1 0;
#X connect 4 0 6 0;
#X connect 6 0 7 0;
#X connect 6 1 0 0;
#X connect 7 0 8 0;
#X connect 8 0 3 0;
#X connect 9 0 10 0;
#X connect 10 0 5 0;
#X connect 11 0 7 1;
#X connect 11 0 9 0;
#X connect 12 0 1 1;
#X connect 13 0 12 0;
#X connect 14 0 11 0;
#X connect 15 0 11 1;
#X restore 110 250 pd pass;
#X obj 11 7 inlet angle;
#N canvas 0 23 450 300 scale 0;
#X obj 9 28 unpack f f;
#X obj 66 51 t f f f;
#X obj 9 51 t f f f;
#X obj 66 73 *, f 4;
#X obj 9 73 *, f 4;
#X obj 9 95 +, f 10;
#X obj 9 117 sqrt;
#X obj 9 153 t b f b f, f 11;
#X obj 9 195 /, f 4;
#X obj 54 195 /, f 4;
#X obj 9 175 f;
#X obj 9 7 inlet;
#X obj 9 239 outlet;
#X obj 54 239 outlet;
#X connect 0 0 2 0;
#X connect 0 1 1 0;
#X connect 1 0 3 0;
#X connect 1 1 3 1;
#X connect 1 2 9 0;
#X connect 2 0 4 0;
#X connect 2 1 4 1;
#X connect 2 2 10 1;
#X connect 3 0 5 1;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 10 0;
#X connect 7 1 8 1;
#X connect 7 2 9 0;
#X connect 7 3 9 1;
#X connect 8 0 12 0;
#X connect 9 0 13 0;
#X connect 10 0 8 0;
#X connect 11 0 0 0;
#X restore 11 392 pd scale;
#X obj 11 437 t b f;
#X obj 75 414 unpack f f;
#X obj 133 348 loadbang;
#X msg 133 370 2;
#X obj 533 34 array define \$0-indices;
#X obj 75 392 array get \$0-indices;
#X obj 533 54 array define \$0-outputs;
#X obj 56 436 array set \$0-outputs, f 26;
#X obj 38 458 array set \$0-outputs;
#X obj 11 479 array get \$0-outputs;
#X obj 533 14 array define \$0-matrix;
#X obj 77 161 array get \$0-matrix;
#X obj 253 11 inlet;
#X obj 75 361 * 2;
#X obj 77 137 * 4;
#X text 283 374 Optim the scale;
#X obj 11 106 t b b;
#X obj 168 55 s \$0-clear;
#N canvas 0 22 133 101 clear.out 0;
#X msg 16 34 const 0;
#X obj 16 56 s \$0-outputs;
#X obj 16 12 r \$0-clear;
#X connect 0 0 1 0;
#X connect 2 0 0 0;
#X restore 533 75 pd clear.out;
#X obj 11 31 t b f b, f 36;
#N canvas 1 23 293 228 resize.array 0;
#X obj 29 61 array size \$0-outputs;
#X obj 29 15 inlet;
#X obj 29 37 route nls indices matrices print;
#N canvas 0 22 242 171 resize.indices 0;
#X obj 7 27 t l l;
#X obj 34 49 list length;
#X obj 7 99 array set \$0-indices;
#X obj 34 78 array size \$0-indices;
#X obj 7 3 inlet;
#X connect 0 0 2 0;
#X connect 0 1 1 0;
#X connect 1 0 3 0;
#X connect 4 0 0 0;
#X restore 76 90 pd resize.indices;
#N canvas 66 414 242 205 resize.matrices 0;
#X obj 24 42 t l l;
#X obj 51 64 list length;
#X obj 51 87 array size \$0-matrix;
#X obj 24 108 array set \$0-matrix;
#X obj 51 152 s \$0-nmatrices;
#X obj 51 130 / 4;
#X obj 24 20 inlet;
#X connect 0 0 3 0;
#X connect 0 1 1 0;
#X connect 1 0 2 0;
#X connect 1 0 5 0;
#X connect 5 0 4 0;
#X connect 6 0 0 0;
#X restore 123 112 pd resize.matrices;
#N canvas 429 176 317 496 print 0;
#X msg 48 82 number of matrices: \$1;
#X obj 48 60 f;
#X obj 63 38 r \$0-nmatrices;
#X obj 21 14 inlet;
#X obj 21 36 t b b;
#N canvas 357 171 193 267 loop 0;
#X obj 8 60 until;
#X obj 8 82 f, f 7;
#X obj 47 60 f 0;
#X obj 59 82 + 1;
#X obj 8 32 t b b, f 7;
#X obj 8 8 inlet;
#X obj 47 158 outlet;
#X obj 8 181 outlet;
#X obj 8 134 sel 256;
#X obj 47 111 r \$0-nmatrices;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 1 0 8 0;
#X connect 2 0 1 1;
#X connect 3 0 1 1;
#X connect 4 0 0 0;
#X connect 4 1 2 0;
#X connect 5 0 4 0;
#X connect 8 0 7 0;
#X connect 8 0 0 1;
#X connect 8 1 6 0;
#X connect 9 0 8 1;
#X restore 21 127 pd loop;
#X obj 137 211 loadbang;
#X obj 79 254 array get \$0-indices;
#X obj 60 394 list prepend;
#X obj 115 321 loadbang;
#X obj 60 150 t f f f;
#X obj 79 276 list append |;
#X obj 60 364 array get \$0-matrix;
#X obj 79 298 list prepend;
#X obj 99 186 list append |;
#X obj 48 104 print vbap 2d;
#X obj 60 414 print vbap 2d;
#X msg 137 233 2;
#X msg 115 343 4;
#X obj 60 342 * 4;
#X obj 79 232 * 2;
#X connect 0 0 15 0;
#X connect 1 0 0 0;
#X connect 2 0 1 1;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 4 1 1 0;
#X connect 5 1 10 0;
#X connect 6 0 17 0;
#X connect 7 0 11 0;
#X connect 8 0 16 0;
#X connect 9 0 18 0;
#X connect 10 0 19 0;
#X connect 10 1 20 0;
#X connect 10 2 14 0;
#X connect 11 0 13 0;
#X connect 12 0 8 0;
#X connect 13 0 8 1;
#X connect 14 0 13 1;
#X connect 17 0 7 1;
#X connect 18 0 12 1;
#X connect 19 0 12 0;
#X connect 20 0 7 0;
#X restore 170 62 pd print;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X connect 2 1 3 0;
#X connect 2 2 4 0;
#X connect 2 3 5 0;
#X restore 253 35 pd resize.array;
#X connect 0 0 14 0;
#X connect 1 0 2 0;
#X connect 1 1 12 0;
#X connect 2 0 0 1;
#X connect 3 0 4 0;
#X connect 3 1 29 0;
#X connect 4 0 5 1;
#X connect 5 0 28 0;
#X connect 6 0 1 0;
#X connect 7 0 8 0;
#X connect 8 0 26 1;
#X connect 9 0 31 0;
#X connect 9 1 3 0;
#X connect 10 0 6 1;
#X connect 10 1 6 2;
#X connect 12 0 4 1;
#X connect 12 0 2 1;
#X connect 13 0 34 0;
#X connect 14 0 15 0;
#X connect 14 1 22 0;
#X connect 15 0 24 0;
#X connect 15 1 23 0;
#X connect 16 0 23 1;
#X connect 16 1 22 1;
#X connect 17 0 18 0;
#X connect 18 0 20 1;
#X connect 20 0 16 0;
#X connect 24 0 11 0;
#X connect 26 0 6 0;
#X connect 27 0 35 0;
#X connect 28 0 20 0;
#X connect 29 0 26 0;
#X connect 31 0 0 0;
#X connect 31 1 5 0;
#X connect 34 0 9 0;
#X connect 34 1 10 0;
#X connect 34 2 32 0;
