#N canvas 538 280 815 444 10;
#X obj 48 5 inlet;
#X obj 48 400 outlet;
#X obj 583 42 array define \$0-matrices;
#X obj 135 182 array get \$0-matrices;
#X obj 583 82 array define \$0-outputs;
#X msg 207 67 const 0;
#X obj 207 89 s \$0-outputs;
#X obj 75 350 array set \$0-outputs;
#X obj 112 330 array set \$0-outputs;
#X obj 48 310 t b f;
#X obj 48 380 array get \$0-outputs;
#X obj 389 13 inlet;
#N canvas 258 61 455 264 get.angles 0;
#X obj 14 169 text search \$1, f 23;
#X obj 14 8 loadbang;
#X msg 14 149 symbol angles;
#X obj 14 191 text get \$1, f 23;
#X obj 14 213 list split 1;
#X obj 73 117 bang;
#X obj 122 118 t b s;
#X obj 73 73 inlet;
#X obj 48 234 outlet;
#X text 140 30 bang to resend the angles;
#X text 140 50 symbol to change the text name;
#X obj 73 97 route bang symbol list, f 25;
#X obj 14 30 t b b, f 8;
#N canvas 0 22 450 300 has.arg 0;
#X obj 21 17 inlet;
#X obj 21 39 symbol \$1;
#X msg 21 61 \$1;
#X obj 21 82 route \$1;
#X obj 21 126 outlet;
#X msg 21 104 1;
#X msg 66 104 0;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 5 0;
#X connect 3 1 6 0;
#X connect 5 0 4 0;
#X connect 6 0 4 0;
#X restore 59 52 pd has.arg;
#X obj 14 75 spigot 0;
#X text 140 10 If symbol arg use it as the name of a text object;
#X text 140 70 list to directly set the angles;
#X connect 0 0 3 0;
#X connect 1 0 12 0;
#X connect 2 0 0 0;
#X connect 3 0 4 0;
#X connect 4 1 8 0;
#X connect 5 0 2 0;
#X connect 6 0 2 0;
#X connect 6 1 0 1;
#X connect 6 1 3 3;
#X connect 7 0 11 0;
#X connect 11 0 5 0;
#X connect 11 1 6 0;
#X connect 11 2 8 0;
#X connect 12 0 14 0;
#X connect 12 1 13 0;
#X connect 13 0 14 1;
#X connect 14 0 2 0;
#X restore 389 37 pd get.angles;
#N canvas 359 132 457 515 get.neighbor.angles 0;
#X obj 13 8 inlet;
#X obj 13 422 outlet;
#X obj 92 424 outlet;
#X obj 28 372 spigot 0;
#X obj 113 372 spigot 0;
#X obj 13 396 f;
#X obj 92 396 list;
#X obj 28 342 f;
#N canvas 198 399 488 375 passer 0;
#X obj 26 13 inlet;
#X obj 236 13 inlet;
#X obj 26 55 unpack f f f, f 25;
#N canvas 243 375 195 173 get.coor 0;
#X obj 20 31 inlet;
#X obj 20 124 outlet;
#X obj 20 98 array get \$0-positions;
#X obj 20 76 pack f 3;
#X obj 20 54 * 3;
#X connect 0 0 4 0;
#X connect 2 0 1 0;
#X connect 3 0 2 0;
#X connect 4 0 3 0;
#X restore 99 76 pd get.coor;
#N canvas 127 510 450 300 distance 0;
#X obj 21 12 inlet;
#X obj 111 12 inlet;
#X obj 21 34 unpack f f f, f 13;
#X obj 111 34 unpack f f f, f 13;
#X obj 21 66 -;
#X obj 60 66 -;
#X obj 99 66 -;
#X obj 21 88 t f f;
#X obj 21 110 *, f 5;
#X obj 60 88 t f f;
#X obj 60 110 *, f 5;
#X obj 99 88 t f f;
#X obj 99 110 *, f 5;
#X obj 60 132 +, f 7;
#X obj 21 154 +, f 7;
#X obj 21 176 sqrt;
#X obj 21 198 outlet;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 2 1 5 0;
#X connect 2 2 6 0;
#X connect 3 0 4 1;
#X connect 3 1 5 1;
#X connect 3 2 6 1;
#X connect 4 0 7 0;
#X connect 5 0 9 0;
#X connect 6 0 11 0;
#X connect 7 0 8 0;
#X connect 7 1 8 1;
#X connect 8 0 14 0;
#X connect 9 0 10 0;
#X connect 9 1 10 1;
#X connect 10 0 13 0;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 12 0 13 1;
#X connect 13 0 14 1;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X restore 26 120 pd distance;
#N canvas 127 510 450 300 distance 0;
#X obj 21 12 inlet;
#X obj 111 12 inlet;
#X obj 21 34 unpack f f f, f 13;
#X obj 111 34 unpack f f f, f 13;
#X obj 21 66 -;
#X obj 60 66 -;
#X obj 99 66 -;
#X obj 21 88 t f f;
#X obj 21 110 *, f 5;
#X obj 60 88 t f f;
#X obj 60 110 *, f 5;
#X obj 99 88 t f f;
#X obj 99 110 *, f 5;
#X obj 60 132 +, f 7;
#X obj 21 154 +, f 7;
#X obj 21 176 sqrt;
#X obj 21 198 outlet;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 2 1 5 0;
#X connect 2 2 6 0;
#X connect 3 0 4 1;
#X connect 3 1 5 1;
#X connect 3 2 6 1;
#X connect 4 0 7 0;
#X connect 5 0 9 0;
#X connect 6 0 11 0;
#X connect 7 0 8 0;
#X connect 7 1 8 1;
#X connect 8 0 14 0;
#X connect 9 0 10 0;
#X connect 9 1 10 1;
#X connect 10 0 13 0;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 12 0 13 1;
#X connect 13 0 14 1;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X restore 99 120 pd distance;
#N canvas 127 510 450 300 distance 0;
#X obj 21 12 inlet;
#X obj 111 12 inlet;
#X obj 21 34 unpack f f f, f 13;
#X obj 111 34 unpack f f f, f 13;
#X obj 21 66 -;
#X obj 60 66 -;
#X obj 99 66 -;
#X obj 21 88 t f f;
#X obj 21 110 *, f 5;
#X obj 60 88 t f f;
#X obj 60 110 *, f 5;
#X obj 99 88 t f f;
#X obj 99 110 *, f 5;
#X obj 60 132 +, f 7;
#X obj 21 154 +, f 7;
#X obj 21 176 sqrt;
#X obj 21 198 outlet;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 2 1 5 0;
#X connect 2 2 6 0;
#X connect 3 0 4 1;
#X connect 3 1 5 1;
#X connect 3 2 6 1;
#X connect 4 0 7 0;
#X connect 5 0 9 0;
#X connect 6 0 11 0;
#X connect 7 0 8 0;
#X connect 7 1 8 1;
#X connect 8 0 14 0;
#X connect 9 0 10 0;
#X connect 9 1 10 1;
#X connect 10 0 13 0;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 12 0 13 1;
#X connect 13 0 14 1;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X restore 173 119 pd distance;
#X obj 99 142 +, f 12;
#X obj 26 163 +, f 12;
#X obj 45 243 <;
#X obj 222 197 f 6;
#X obj 26 189 t f f f;
#X obj 56 269 pack f f 6;
#X obj 71 242 spigot 0;
#N canvas 243 375 195 173 get.coor 0;
#X obj 20 31 inlet;
#X obj 20 124 outlet;
#X obj 20 98 array get \$0-positions;
#X obj 20 76 pack f 3;
#X obj 20 54 * 3;
#X connect 0 0 4 0;
#X connect 2 0 1 0;
#X connect 3 0 2 0;
#X connect 4 0 3 0;
#X restore 26 76 pd get.coor;
#N canvas 243 375 195 173 get.coor 0;
#X obj 20 31 inlet;
#X obj 20 124 outlet;
#X obj 20 98 array get \$0-positions;
#X obj 20 76 pack f 3;
#X obj 20 54 * 3;
#X connect 0 0 4 0;
#X connect 2 0 1 0;
#X connect 3 0 2 0;
#X connect 4 0 3 0;
#X restore 173 76 pd get.coor;
#X obj 45 296 outlet;
#X obj 26 98 t l l;
#X obj 99 98 t l l;
#X obj 173 98 t l l;
#X obj 26 35 t l l;
#X obj 236 35 t l b;
#X connect 0 0 20 0;
#X connect 1 0 21 0;
#X connect 2 0 14 0;
#X connect 2 1 3 0;
#X connect 2 2 15 0;
#X connect 3 0 18 0;
#X connect 4 0 8 0;
#X connect 5 0 7 0;
#X connect 6 0 7 1;
#X connect 7 0 8 1;
#X connect 8 0 11 0;
#X connect 9 0 12 0;
#X connect 9 0 13 1;
#X connect 9 0 16 0;
#X connect 10 0 9 1;
#X connect 10 0 12 2;
#X connect 11 0 13 0;
#X connect 11 1 9 0;
#X connect 11 2 12 1;
#X connect 13 0 9 1;
#X connect 13 0 12 2;
#X connect 14 0 17 0;
#X connect 15 0 19 0;
#X connect 17 0 4 0;
#X connect 18 0 5 0;
#X connect 19 0 6 0;
#X connect 20 0 2 0;
#X connect 21 0 4 1;
#X connect 21 0 5 1;
#X connect 21 0 6 1;
#X connect 21 1 10 0;
#X restore 140 273 pd passer;
#X obj 13 30 t b b l, f 25;
#X obj 13 232 t b b;
#X obj 86 94 t f b, f 7;
#X obj 86 116 until;
#X obj 125 116 f 0;
#X obj 86 138 f, f 7;
#X obj 135 138 + 1;
#X obj 113 182 * 3;
#X obj 113 227 array get \$0-triplets;
#X obj 101 52 r \$0-ntriplets;
#X obj 113 204 pack f 3;
#X obj 86 72 f;
#X obj 86 160 t f f;
#X obj 113 249 t l l;
#X connect 0 0 9 0;
#X connect 3 0 5 1;
#X connect 4 0 6 1;
#X connect 5 0 1 0;
#X connect 6 0 2 0;
#X connect 7 0 3 0;
#X connect 8 0 4 1;
#X connect 8 0 3 1;
#X connect 9 0 10 0;
#X connect 9 1 20 0;
#X connect 9 2 8 1;
#X connect 10 0 5 0;
#X connect 10 1 6 0;
#X connect 11 0 12 0;
#X connect 11 1 13 0;
#X connect 12 0 14 0;
#X connect 13 0 14 1;
#X connect 14 0 15 0;
#X connect 14 0 21 0;
#X connect 15 0 14 1;
#X connect 16 0 19 0;
#X connect 17 0 22 0;
#X connect 18 0 20 1;
#X connect 19 0 17 0;
#X connect 20 0 11 0;
#X connect 21 0 7 0;
#X connect 21 1 16 0;
#X connect 22 0 4 0;
#X connect 22 1 8 0;
#X restore 135 113 pd get.neighbor.angles;
#X obj 135 140 * 9;
#X obj 48 243 3d/mat.vec.mul, f 15;
#X obj 48 288 unpack f f f, f 22;
#X obj 177 310 array set \$0-outputs;
#X obj 48 266 3d/gain.scale;
#X obj 48 46 t l l b, f 27;
#X obj 48 25 3d/pol.to.car;
#X obj 135 162 pack f 9;
#N canvas 0 22 302 350 array.resize 0;
#X obj 48 88 array size \$0-outputs;
#X obj 42 112 t f f f, f 10;
#X obj 70 134 - 1;
#X obj 42 134 - 2;
#X obj 70 156 *, f 5;
#X obj 42 178 *, f 5;
#X obj 42 200 / 6;
#X obj 22 284 * 3;
#X obj 22 309 array size \$0-positions;
#X obj 22 27 r \$0-nls;
#X obj 42 243 array size \$0-triplets;
#X obj 42 222 * 3;
#X obj 141 125 r \$0-ntriplets;
#X obj 141 169 array size \$0-matrices;
#X obj 141 148 * 9;
#X connect 1 0 3 0;
#X connect 1 1 2 0;
#X connect 1 2 4 1;
#X connect 2 0 4 0;
#X connect 3 0 5 0;
#X connect 4 0 5 1;
#X connect 5 0 6 0;
#X connect 6 0 11 0;
#X connect 7 0 8 0;
#X connect 9 0 0 0;
#X connect 9 0 1 0;
#X connect 9 0 7 0;
#X connect 11 0 10 0;
#X connect 12 0 14 0;
#X connect 14 0 13 0;
#X restore 583 117 pd array.resize;
#X obj 583 22 array define \$0-positions;
#N canvas 429 139 223 290 array.positions.fill 0;
#X obj 24 76 f;
#X obj 24 98 until;
#X obj 24 10 inlet;
#X obj 24 190 list split 2;
#X obj 24 235 array set \$0-positions;
#X obj 51 140 f;
#X obj 24 32 t b l b, f 24;
#X obj 69 120 f 0;
#X obj 24 120 t b b;
#X obj 81 140 + 3;
#X obj 24 212 3d/pol.to.car;
#X obj 24 162 list, f 12;
#X obj 39 54 r \$0-nls;
#X connect 0 0 1 0;
#X connect 1 0 8 0;
#X connect 2 0 6 0;
#X connect 3 0 10 0;
#X connect 3 1 11 1;
#X connect 5 0 9 0;
#X connect 5 0 4 1;
#X connect 6 0 0 0;
#X connect 6 1 11 1;
#X connect 6 2 7 0;
#X connect 7 0 5 1;
#X connect 8 0 11 0;
#X connect 8 1 5 0;
#X connect 9 0 5 1;
#X connect 10 0 4 0;
#X connect 11 0 3 0;
#X connect 12 0 0 1;
#X restore 423 105 pd array.positions.fill;
#N canvas 0 22 190 132 send.nls 0;
#X obj 18 12 inlet;
#X obj 18 34 list length;
#X obj 18 56 / 2;
#X obj 18 78 s \$0-nls;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X restore 440 83 pd send.nls;
#N canvas 463 93 666 688 compute.inv.matrices 1;
#X obj 33 272 unpack f f f, f 25;
#N canvas 243 375 176 147 get.coor 0;
#X obj 10 11 inlet;
#X obj 10 103 outlet;
#X obj 10 56 pack f 3;
#X obj 10 34 * 3;
#X obj 10 78 array get \$0-positions;
#X connect 0 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X restore 33 317 pd get.coor;
#X text 258 301 For each triplet of angles compute the inverse matrix
, f 21;
#X text 204 414 Transpose;
#X obj 33 436 3d/mat.inv;
#X text 104 437 Inverse;
#X obj 106 341 list append, f 12;
#X obj 33 362 list append, f 12;
#N canvas 243 375 176 147 get.coor 0;
#X obj 10 11 inlet;
#X obj 10 103 outlet;
#X obj 10 56 pack f 3;
#X obj 10 34 * 3;
#X obj 10 78 array get \$0-positions;
#X connect 0 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X restore 106 317 pd get.coor;
#N canvas 243 375 176 147 get.coor 0;
#X obj 10 11 inlet;
#X obj 10 103 outlet;
#X obj 10 56 pack f 3;
#X obj 10 34 * 3;
#X obj 10 78 array get \$0-positions;
#X connect 0 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X restore 180 317 pd get.coor;
#X obj 33 492 array set \$0-matrices, f 22;
#X obj 96 466 * 9;
#X obj 33 76 t f b, f 7;
#X obj 33 98 until;
#X obj 72 98 f 0;
#X obj 33 120 f, f 7;
#X obj 82 120 + 1;
#X obj 33 172 * 3;
#X obj 33 247 array get \$0-triplets;
#X obj 48 34 r \$0-ntriplets;
#X obj 33 224 pack f 3;
#X obj 33 54 f;
#X obj 33 12 inlet;
#X obj 33 142 t f f;
#X msg 31 397 \$1 \$4 \$7 \$2 \$5 \$8 \$3 \$6 \$9;
#X connect 0 0 1 0;
#X connect 0 1 8 0;
#X connect 0 2 9 0;
#X connect 1 0 7 0;
#X connect 4 0 10 0;
#X connect 6 0 7 1;
#X connect 7 0 24 0;
#X connect 8 0 6 0;
#X connect 9 0 6 1;
#X connect 11 0 10 1;
#X connect 12 0 13 0;
#X connect 12 1 14 0;
#X connect 13 0 15 0;
#X connect 14 0 15 1;
#X connect 15 0 16 0;
#X connect 15 0 23 0;
#X connect 16 0 15 1;
#X connect 17 0 20 0;
#X connect 18 0 0 0;
#X connect 19 0 21 1;
#X connect 20 0 18 0;
#X connect 21 0 12 0;
#X connect 22 0 21 0;
#X connect 23 0 17 0;
#X connect 23 1 11 0;
#X connect 24 0 4 0;
#X restore 389 147 pd compute.inv.matrices;
#X obj 133 264 unpack f f f, f 13;
#X obj 583 62 array define \$0-triplets;
#X obj 389 59 t b b l l;
#N canvas 631 84 459 614 filter.triplets 0;
#X obj 22 10 inlet;
#X obj 50 59 3d/loop.nls;
#X obj 113 14 r \$0-nls;
#X obj 77 118 unpack f f f, f 33;
#N canvas 243 375 176 147 get.coor 0;
#X obj 10 11 inlet;
#X obj 10 103 outlet;
#X obj 10 56 pack f 3;
#X obj 10 34 * 3;
#X obj 10 78 array get \$0-positions;
#X connect 0 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X restore 77 143 pd get.coor;
#N canvas 243 375 176 147 get.coor 0;
#X obj 10 11 inlet;
#X obj 10 103 outlet;
#X obj 10 56 pack f 3;
#X obj 10 34 * 3;
#X obj 10 78 array get \$0-positions;
#X connect 0 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X restore 174 143 pd get.coor;
#N canvas 243 375 176 147 get.coor 0;
#X obj 10 11 inlet;
#X obj 10 103 outlet;
#X obj 10 56 pack f 3;
#X obj 10 34 * 3;
#X obj 10 78 array get \$0-positions;
#X connect 0 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 1 0;
#X restore 273 143 pd get.coor;
#X obj 174 165 3d/dist.euclidean;
#X obj 104 195 3d/dist.euclidean;
#X obj 77 165 t l l;
#X obj 77 225 3d/dist.euclidean;
#X obj 113 36 t f b;
#X obj 140 58 f 2;
#X obj 50 81 t l l;
#X obj 50 396 spigot;
#X obj 107 446 f;
#X obj 117 418 f 0;
#X obj 138 446 + 1;
#X obj 22 32 t b b b, f 10;
#X obj 22 475 f;
#X obj 50 418 t l b, f 10;
#X obj 107 468 * 3;
#X obj 22 527 s \$0-ntriplets;
#X obj 50 496 array set \$0-triplets;
#X obj 217 250 +;
#X obj 167 304 +;
#X obj 167 326 < 4;
#X obj 22 497 + 1;
#X connect 0 0 18 0;
#X connect 1 0 13 0;
#X connect 2 0 11 0;
#X connect 3 0 4 0;
#X connect 3 1 5 0;
#X connect 3 2 6 0;
#X connect 4 0 9 0;
#X connect 5 0 7 0;
#X connect 5 0 10 1;
#X connect 6 0 7 1;
#X connect 6 0 8 1;
#X connect 7 0 24 1;
#X connect 8 0 24 0;
#X connect 9 0 10 0;
#X connect 9 1 8 0;
#X connect 10 0 25 0;
#X connect 11 0 1 1;
#X connect 11 1 12 0;
#X connect 13 0 14 0;
#X connect 13 1 3 0;
#X connect 14 0 20 0;
#X connect 15 0 17 0;
#X connect 15 0 21 0;
#X connect 15 0 19 1;
#X connect 16 0 15 1;
#X connect 17 0 15 1;
#X connect 18 0 19 0;
#X connect 18 1 1 0;
#X connect 18 2 16 0;
#X connect 19 0 27 0;
#X connect 20 0 23 0;
#X connect 20 1 15 0;
#X connect 21 0 23 1;
#X connect 24 0 25 1;
#X connect 25 0 26 0;
#X connect 26 0 14 1;
#X connect 27 0 22 0;
#X restore 406 126 pd filter.triplets;
#X obj 582 222 array get \$0-positions;
#X obj 582 155 nbx 5 14 -1e+37 1e+37 0 0 empty empty empty 0 -8 0 10
-262144 -1 -1 0 256;
#X obj 582 275 nbx 5 14 -1e+37 1e+37 0 0 empty empty empty 0 -8 0 10
-262144 -1 -1 0 256;
#X obj 582 194 pack f 3;
#X obj 582 314 pack f 3;
#X obj 582 244 print pos;
#X obj 582 364 print triplet;
#X obj 582 342 array get \$0-triplets;
#X obj 582 174 * 3;
#X obj 582 294 * 3;
#X msg 372 270 \$9 \$8 \$7 \$6 \$5 \$4 \$3 \$2 \$1;
#X msg 48 203 \$1 \$2 \$3;
#X connect 0 0 20 0;
#X connect 3 0 41 0;
#X connect 3 0 15 1;
#X connect 5 0 6 0;
#X connect 9 0 10 0;
#X connect 9 1 7 0;
#X connect 10 0 1 0;
#X connect 11 0 12 0;
#X connect 12 0 29 0;
#X connect 13 0 14 0;
#X connect 13 1 27 0;
#X connect 14 0 21 0;
#X connect 15 0 18 0;
#X connect 16 0 9 0;
#X connect 16 1 8 0;
#X connect 16 2 17 0;
#X connect 18 0 16 0;
#X connect 19 0 42 0;
#X connect 19 1 13 0;
#X connect 19 2 5 0;
#X connect 20 0 19 0;
#X connect 21 0 3 0;
#X connect 27 0 7 1;
#X connect 27 1 8 1;
#X connect 27 2 17 1;
#X connect 29 0 26 0;
#X connect 29 1 30 0;
#X connect 29 2 24 0;
#X connect 29 3 25 0;
#X connect 31 0 36 0;
#X connect 32 0 39 0;
#X connect 33 0 40 0;
#X connect 34 0 31 0;
#X connect 35 0 38 0;
#X connect 38 0 37 0;
#X connect 39 0 34 0;
#X connect 40 0 35 0;
#X connect 42 0 15 0;
